---
title: "TanStack Queryã§ä½œã‚‹æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ "
emoji: "ğŸˆ"
type: "tech"
topics: ["TanStackQuery", "React", "ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°", "æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ", "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹"]
published: true
---

# TanStack Queryã§ä½œã‚‹æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ 

## ã¯ã˜ã‚ã«

ç¾ä»£ã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¨ç®¡ç†ã¯éå¸¸ã«é‡è¦ãªè¦ç´ ã§ã™ã€‚ç‰¹ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã®æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®é‡è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚TanStack Queryï¼ˆæ—§React Queryï¼‰ã¯ã€Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚’ç°¡ç´ åŒ–ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€TanStack Queryã‚’ä½¿ç”¨ã—ã¦æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚

## TanStack Queryã¨ã¯ï¼Ÿ

TanStack Queryã¯ã€Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã€åŒæœŸã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãŒç°¡å˜ã«ãªã‚Šã€çŠ¶æ…‹ç®¡ç†ã®è¤‡é›‘ã•ã‚’è»½æ¸›ã—ã¾ã™ã€‚TanStack Queryã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

- **ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°**: APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ç°¡å˜ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é–‹ç™ºè€…ã¯HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‰‹å‹•ã§ç®¡ç†ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€`fetch`ã‚„`axios`ã‚’ä½¿ã£ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç°¡æ½”ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
  
- **ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**: å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’å†åº¦å–å¾—ã™ã‚‹éš›ã®å¾…æ©Ÿæ™‚é–“ã‚’çŸ­ç¸®ã§ãã¾ã™ã€‚TanStack Queryã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€å¿…è¦ã«å¿œã˜ã¦è‡ªå‹•çš„ã«å†å–å¾—ã—ã¾ã™ã€‚

- **è‡ªå‹•ãƒªãƒ•ã‚§ãƒƒãƒ**: ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã«è‡ªå‹•çš„ã«å†å–å¾—ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¸¸ã«æœ€æ–°ã®æƒ…å ±ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ãªãã¦ã‚‚æœ€æ–°ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

- **ã‚¯ã‚¨ãƒªã®ç„¡åŠ¹åŒ–**: ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦ã‚¯ã‚¨ãƒªã‚’ç„¡åŠ¹åŒ–ã™ã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä¸è¦ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é˜²ãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã‚’è¡Œã£ã¦ã„ãªã„å ´åˆã«ã‚¯ã‚¨ãƒªã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã«ã‚ˆã‚Šã€é–‹ç™ºè€…ã¯ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã«ã‹ã‹ã‚‹æ™‚é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã€ã‚ˆã‚Šè¿…é€Ÿã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

### TanStack Queryã®ãƒ•ãƒ­ãƒ¼

ä»¥ä¸‹ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã¯ã€TanStack Queryã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ã®æµã‚Œã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã®ãƒ•ãƒ­ãƒ¼ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚’å®Ÿè¡Œã—ãŸéš›ã«ã©ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã•ã‚Œã€è¡¨ç¤ºã•ã‚Œã‚‹ã‹ã‚’è¦–è¦šçš„ã«è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚

```mermaid
flowchart TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›] --> B{ã‚¯ã‚¨ãƒªãŒæœ‰åŠ¹ã‹?}
    B -- Yes --> C[APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—]
    C --> D[ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥]
    D --> E[æ¤œç´¢çµæœã‚’è¡¨ç¤º]
    B -- No --> F[ä½•ã‚‚ã—ãªã„]
```

ã“ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚’è¡Œã£ãŸéš›ã®ä¸€é€£ã®æµã‚Œã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã‚¯ã‚¨ãƒªãŒæœ‰åŠ¹ã‹ã©ã†ã‹ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã€æœ‰åŠ¹ã§ã‚ã‚Œã°APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã•ã‚Œã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¦ã‹ã‚‰æ¤œç´¢çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ç„¡åŠ¹ãªå ´åˆã¯ä½•ã‚‚è¡Œã‚ã‚Œã¾ã›ã‚“ã€‚

## æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã®åŸºæœ¬æ§‹é€ 

æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚åŸºæœ¬çš„ãªæ§‹é€ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

1. **å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€‚
2. **æ¤œç´¢ãƒœã‚¿ãƒ³**: æ¤œç´¢ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã€‚
3. **çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢**: æ¤œç´¢çµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚¨ãƒªã‚¢ã€‚

ä»¥ä¸‹ã¯ã€åŸºæœ¬çš„ãªæ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã™ã€‚

```jsx
import React, { useState } from 'react';

const SearchForm = ({ onSearch }) => {
  const [query, setQuery] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    onSearch(query);
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›"
      />
      <button type="submit">æ¤œç´¢</button>
    </form>
  );
};

export default SearchForm;
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`useState`ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ç®¡ç†ã—ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨`onSearch`é–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

## TanStack Queryã‚’ä½¿ã£ãŸæ¤œç´¢æ©Ÿèƒ½ã®å®Ÿè£…

### 1. TanStack Queryã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã¾ãšã€TanStack Queryã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```bash
npm install @tanstack/react-query
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€TanStack Queryã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã®æ©Ÿèƒ½ã‚’ç°¡å˜ã«åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

### 2. ã‚¯ã‚¨ãƒªã®è¨­å®š

æ¬¡ã«ã€TanStack Queryã‚’ä½¿ç”¨ã—ã¦APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚¯ã‚¨ãƒªã‚’è¨­å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã¯ã€æ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªã‚¯ã‚¨ãƒªã®ä¾‹ã§ã™ã€‚

```jsx
import { useQuery } from '@tanstack/react-query';

const fetchSearchResults = async (query) => {
  const response = await fetch(`https://api.example.com/search?q=${query}`);
  if (!response.ok) {
    throw new Error('Network response was not ok');
  }
  return response.json();
};

const useSearchResults = (query) => {
  return useQuery(['searchResults', query], () => fetchSearchResults(query), {
    enabled: !!query, // queryãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿å®Ÿè¡Œ
  });
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`fetchSearchResults`é–¢æ•°ãŒAPIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€`useSearchResults`ãƒ•ãƒƒã‚¯ãŒã‚¯ã‚¨ãƒªã‚’ç®¡ç†ã—ã¾ã™ã€‚`enabled`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¯ã‚¨ãƒªãŒç©ºã§ãªã„å ´åˆã«ã®ã¿å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç„¡é§„ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é˜²ãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚

### 3. æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨çµæœè¡¨ç¤ºã®çµ±åˆ

æ¬¡ã«ã€æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨æ¤œç´¢çµæœã‚’çµ±åˆã—ã¾ã™ã€‚ä»¥ä¸‹ã¯ã€æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨çµæœè¡¨ç¤ºã‚’çµ„ã¿åˆã‚ã›ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä¾‹ã§ã™ã€‚

```jsx
import React, { useState } from 'react';
import { useQuery } from '@tanstack/react-query';

const fetchSearchResults = async (query) => {
  const response = await fetch(`https://api.example.com/search?q=${query}`);
  if (!response.ok) {
    throw new Error('Network response was not ok');
  }
  return response.json();
};

const useSearchResults = (query) => {
  return useQuery(['searchResults', query], () => fetchSearchResults(query), {
    enabled: !!query,
  });
};

const SearchForm = ({ onSearch }) => {
  const [query, setQuery] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    onSearch(query);
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›"
      />
      <button type="submit">æ¤œç´¢</button>
    </form>
  );
};

const SearchResults = ({ query }) => {
  const { data, error, isLoading } = useSearchResults(query);

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error.message}</div>;

  return (
    <ul>
      {data.results.map((result) => (
        <li key={result.id}>{result.title}</li>
      ))}
    </ul>
  );
};

const SearchComponent = () => {
  const [query, setQuery] = useState('');

  return (
    <div>
      <SearchForm onSearch={setQuery} />
      {query && <SearchResults query={query} />}
    </div>
  );
};

export default SearchComponent;
```

ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã¯ã€`SearchForm`ãŒæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å—ã‘å–ã‚Šã€`SearchResults`ãŒãã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦æ¤œç´¢çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç°¡å˜ã«æƒ…å ±ã‚’æ¤œç´¢ã—ã€çµæœã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## æ¤œç´¢æ©Ÿèƒ½ã®æ‹¡å¼µ

### 1. ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ©Ÿèƒ½ã®è¿½åŠ 

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã™ã‚‹ãŸã³ã«APIã‚’å‘¼ã³å‡ºã™ã®ã§ã¯ãªãã€ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒã‚¦ãƒ³ã‚¹ã¨ã¯ã€ä¸€å®šã®æ™‚é–“ãŒçµŒéã™ã‚‹ã¾ã§å‡¦ç†ã‚’é…å»¶ã•ã›ã‚‹æŠ€è¡“ã§ã™ã€‚ä»¥ä¸‹ã¯ã€ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸä¾‹ã§ã™ã€‚

```jsx
import { useEffect } from 'react';

const useDebounce = (value, delay) => {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);

  return debouncedValue;
};

// SearchComponentå†…ã§ã®ä½¿ç”¨
const SearchComponent = () => {
  const [query, setQuery] = useState('');
  const debouncedQuery = useDebounce(query, 300); // 300msã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹

  return (
    <div>
      <SearchForm onSearch={setQuery} />
      {debouncedQuery && <SearchResults query={debouncedQuery} />}
    </div>
  );
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`useDebounce`ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ãŒ300msé–“ç¶šã„ãŸå¾Œã«ã®ã¿æ¤œç´¢ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’æ¸›ã‚‰ã—ã€ã‚µãƒ¼ãƒãƒ¼ã¸ã®è² è·ã‚’è»½æ¸›ã—ã¾ã™ã€‚

### 2. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…

æ¤œç´¢çµæœãŒå¤šã„å ´åˆã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒçµæœã‚’ã‚ˆã‚Šç°¡å˜ã«ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€çµæœã‚’è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã«åˆ†å‰²ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®ãƒšãƒ¼ã‚¸ã‚’é¸æŠã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚ä»¥ä¸‹ã¯ã€ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ãŸä¾‹ã§ã™ã€‚

```jsx
const SearchResults = ({ query }) => {
  const [page, setPage] = useState(1);
  const { data, error, isLoading } = useSearchResults(query, page);

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error.message}</div>;

  return (
    <div>
      <ul>
        {data.results.map((result) => (
          <li key={result.id}>{result.title}</li>
        ))}
      </ul>
      <button onClick={() => setPage((prev) => Math.max(prev - 1, 1))}>å‰ã®ãƒšãƒ¼ã‚¸</button>
      <button onClick={() => setPage((prev) => prev + 1)}>æ¬¡ã®ãƒšãƒ¼ã‚¸</button>
    </div>
  );
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ãƒšãƒ¼ã‚¸ç•ªå·ã‚’ç®¡ç†ã—ã€å‰ã®ãƒšãƒ¼ã‚¸ã¨æ¬¡ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¤§é‡ã®æ¤œç´¢çµæœã‚’åŠ¹ç‡çš„ã«é–²è¦§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹

æ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹éš›ã«ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ç®¡ç†ãŒé‡è¦ã§ã™ã€‚TanStack Queryã¯ã€ã“ã‚Œã‚‰ã®çŠ¶æ…‹ã‚’ç°¡å˜ã«ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã®ä¾‹ã§ã™ã€‚

```jsx
const SearchResults = ({ query }) => {
  const { data, error, isLoading } = useSearchResults(query);

  if (isLoading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {error.message}</div>;

  return (
    <ul>
      {data.results.map((result) => (
        <li key={result.id}>{result.title}</li>
      ))}
    </ul>
  );
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`isLoading`ã¨`error`ã®çŠ¶æ…‹ã«åŸºã¥ã„ã¦é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç†è§£ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

## ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã®å‘ä¸Š

æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚„çµæœè¡¨ç¤ºã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚CSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€è¦‹ãŸç›®ã‚’æ”¹å–„ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ç°¡å˜ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã®ä¾‹ã§ã™ã€‚

```css
form {
  display: flex;
  margin-bottom: 20px;
}

input {
  flex: 1;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

button {
  padding: 10px 15px;
  margin-left: 10px;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button:hover {
  background-color: #0056b3;
}
```

ã“ã®CSSã¯ã€æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã®è¦‹ãŸç›®ã‚’æ”¹å–„ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½¿ã„ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹éš›ã®å°è±¡ã‚’å¤§ããå·¦å³ã™ã‚‹ãŸã‚ã€æ³¨æ„æ·±ãè¨­è¨ˆã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

## ã•ã‚‰ãªã‚‹æ©Ÿèƒ½ã®è¿½åŠ 

### 1. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã®å®Ÿè£…

æ¤œç´¢çµæœã‚’ã•ã‚‰ã«çµã‚Šè¾¼ã‚€ãŸã‚ã«ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ç‰¹å®šã®ã‚«ãƒ†ã‚´ãƒªã‚„æ—¥ä»˜ç¯„å›²ã§çµæœã‚’çµã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸä¾‹ã§ã™ã€‚

```jsx
const FilterForm = ({ onFilterChange }) => {
  const [category, setCategory] = useState('');

  const handleCategoryChange = (e) => {
    setCategory(e.target.value);
    onFilterChange(e.target.value);
  };

  return (
    <div>
      <label>
        ã‚«ãƒ†ã‚´ãƒª:
        <select value={category} onChange={handleCategoryChange}>
          <option value="">ã™ã¹ã¦</option>
          <option value="news">ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
          <option value="articles">è¨˜äº‹</option>
        </select>
      </label>
    </div>
  );
};

const SearchComponent = () => {
  const [query, setQuery] = useState('');
  const [category, setCategory] = useState('');

  return (
    <div>
      <SearchForm onSearch={setQuery} />
      <FilterForm onFilterChange={setCategory} />
      {query && <SearchResults query={query} category={category} />}
    </div>
  );
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`FilterForm`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚é¸æŠã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã¯ã€æ¤œç´¢çµæœã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

### 2. æ¤œç´¢å±¥æ­´ã®ç®¡ç†

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒéå»ã«è¡Œã£ãŸæ¤œç´¢ã‚’è¨˜éŒ²ã—ã€å†åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€æ¤œç´¢å±¥æ­´ã®ç®¡ç†æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä»¥å‰ã®æ¤œç´¢ã‚’ç°¡å˜ã«å†å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```jsx
const SearchHistory = ({ history, onSelect }) => {
  return (
    <ul>
      {history.map((item, index) => (
        <li key={index} onClick={() => onSelect(item)}>
          {item}
        </li>
      ))}
    </ul>
  );
};

const SearchComponent = () => {
  const [query, setQuery] = useState('');
  const [history, setHistory] = useState([]);

  const handleSearch = (newQuery) => {
    setQuery(newQuery);
    setHistory((prev) => [...new Set([newQuery, ...prev])]); // é‡è¤‡ã‚’æ’é™¤
  };

  return (
    <div>
      <SearchForm onSearch={handleSearch} />
      <SearchHistory history={history} onSelect={setQuery} />
      {query && <SearchResults query={query} />}
    </div>
  );
};
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`SearchHistory`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒéå»ã®æ¤œç´¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å†å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åŠ¹ç‡çš„ã«æƒ…å ±ã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## ã¾ã¨ã‚

æœ¬è¨˜äº‹ã§ã¯ã€TanStack Queryã‚’ä½¿ç”¨ã—ã¦æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã—ãŸã€‚TanStack Queryã®å¼·åŠ›ãªæ©Ÿèƒ½ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚„ç®¡ç†ãŒç°¡ç´ åŒ–ã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã®åŸºæœ¬çš„ãªæ§‹é€ ã‹ã‚‰å§‹ã¾ã‚Šã€ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ©Ÿèƒ½ã‚„ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã€ã•ã‚‰ã«ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚„æ¤œç´¢å±¥æ­´ã®ç®¡ç†ã¾ã§ã€ã•ã¾ã–ã¾ãªè¦ç´ ã‚’å–ã‚Šä¸Šã’ã¾ã—ãŸã€‚

ä»Šå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦ã€TanStack Queryã‚’æ´»ç”¨ã—ã¦åŠ¹æœçš„ãªæ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹éš›ã®å‚è€ƒã«ã—ã¦ã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚ã•ã‚‰ã«å­¦ç¿’ã‚’é€²ã‚ã‚‹ãŸã‚ã®ãƒªã‚½ãƒ¼ã‚¹ã¨ã—ã¦ã€TanStack Queryã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ã€Reactã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«é–¢ã™ã‚‹è³‡æ–™ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚